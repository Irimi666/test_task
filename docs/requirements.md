## Требования 
Онлайн-маркетплейс товаров. Необходимо реализовать отправку пуш-уведомлений в мобильное приложение об изменении статуса заказа. Данные об изменении статуса получать из API внешнего сервиса.

## Бизнес-процесс

1. Внешний сервис изменяет статус заказа (например, с "заказ прошел сортировку" на "передан службе доставки")

2. Маркетплейс получает уведомление об изменении статуса

    * Через вебхук
    * Опросом API (каждые 5 минут)

3. Система маркетплейса:

    * Проверяет, требуется ли отправка уведомления для нового статуса

    * Находит токен устройства пользователя в БД

    * Формирует контент пуш‑уведомления

    * Отправляет запрос в сервис пуш‑уведомлений (FCM/APNs)

4. Сервис пуш‑уведомлений (FCM/APNs) отправляет уведомление в мобильное приложение

5. Логирование всех этапов процесса

**BPMN-диаграмма процесса:**

![BPMN: Бизнес процесс отправки уведомлений](/diagrams/business-process-pic.png)

[.bpmn-файл](/diagrams/business-process.bpmn)

**UML-диаграмма статусов:**

![uml-state-diagram](/diagrams/condition-status-diagram.png)

**Описание статусов:**

*  Создан — заказ создан, но не оплачен

* Оплачен — заказ оплачен, готов к обработке

* Подтвержден - заказ обработан, готов к передаче в доставку

* Передан в доставку — заказ передан в службу доставки

* В пути — доставка началась, заказ движется к получателю

* Доставлен — заказ успешно доставлен пользователю

* Отменён — заказ отменён пользователем или системой

**UML-диаграмма состояний:**

![UML: статусы уведомлений](/diagrams/notification-status-diagram.png)

[.html-файл](diagrams/status-diagram.html)

**Описание состояний:**

* CREATED - уведомление получено -> начать отправку

* SENDING - отправка уведомления -> успешно доставлено / не доставлено

* DELIVERED - уведомление доставлено -> завершение процесса

* FAILED - уведомление не доставлено -> завершение процесса

* CANCELLED - отправка отменена -> завершение процесса

## Функциональные требования

1. Система должна получать данные о статусе заказ из внешнего API
2. Поддерживать два механизма получения данных:
    * вебхуки (основной режим)
    * периодический опрос API (резервный режим)
3. Сохранять актуальный статус заказа в БД
4. Для каждого изменения статуса проверять, требуется ли отправка пуш‑уведомления (согласно таблице статусов).
5. Сформировать контент уведомления
6. Отправить push-уведомление через сервис уведомлений APNs(IOS)/FCM(Android)
7. Регистрировать все события в логах


## Нефункциональные требования 

1. Доступность системы — N % времени
2. Время отправки пуш‑уведомления после изменения статуса — не позднее N секунд
3. Время обработки обновления статуса заказа — не более N секунд
4. Надежность доставки уведомлений
5. Поддержка масштабирования: система должна выдерживать рост числа заказов и пользователей без существенного снижения производительности
6. Безопасность: обмен данными с внешним сервисом должен осуществляться по защищённому соединению (HTTPS), доступ к API — через токен аутентификации
7. Понятность уведомлений: тексты пуш‑уведомлений должны быть краткими, понятными и локализованными




